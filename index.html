<script>
document.getElementById("daftarForm").addEventListener("submit", function(e){
  e.preventDefault();

  const nama = document.getElementById("nama").value;
  const statusDiv = document.getElementById("status");
  const spinner = document.getElementById("spinner");

  spinner.style.display = "inline-block";
  statusDiv.innerText = "";

  fetch("https://script.google.com/macros/s/AKfycbzyP3xdStmBZWhTCCiD2d-CZ6HPF97mjPgPfTyYQrcX075vilsSOr48ZLxgLvrJpfQ/exec?action=daftar&nama=" + encodeURIComponent(nama))
    .then(response => {
      if (!response.ok) {
        throw new Error("Network response was not ok");
      }
      return response.json();   // ✅ ini pastikan response dibaca sebagai JSON
    })
    .then(data => {
      spinner.style.display = "none";
      console.log(data); // untuk debug
      
      if (data && data.nama) {
        statusDiv.innerHTML = `<span style="color:green">✅ ${data.nama} berjaya daftar!</span>`;
      } else {
        statusDiv.innerHTML = `<span style="color:red">⚠️ Ralat: Tiada data nama.</span>`;
      }
    })
    .catch(error => {
      spinner.style.display = "none";
      console.error("Error:", error);
      statusDiv.innerHTML = `<span style="color:red">⚠️ Ralat sambungan: ${error.message}</span>`;
    });
});
</script>
